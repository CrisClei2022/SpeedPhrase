<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SpeedPhrase</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body { 
      font-family: Arial, sans-serif; 
      background: #f9f9f9; 
      padding-top: 80px;
      padding-bottom: 80px;
    }

    .hidden {
      display: none;
    }

    /* ========== HEADER ========== */
    .main-header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background-color: #fff;
      border-bottom: 1px solid #ddd;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      z-index: 1000;
    }

    .header-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .nav-button {
      display: flex;
      align-items: center;
      gap: 8px;
      background: none;
      border: none;
      padding: 8px 12px;
      cursor: pointer;
      border-radius: 8px;
      transition: background-color 0.2s;
      font-size: 14px;
    }

    .nav-button:hover {
      background-color: #f0f8ff;
    }

    .nav-icon {
      font-size: 1.2em;
    }

    .header-center {
      text-align: center;
      flex: 1;
    }

    .header-title {
      font-size: 1.5em;
      color: #333;
      margin-bottom: 5px;
    }

    .exercise-status {
      display: flex;
      flex-direction: column;
      gap: 5px;
      font-size: 0.9em;
    }

    .status-line {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 500;
      justify-content: center;
    }

    .status-line::before {
      content: '';
      font-size: 1.2em;
    }

    .status-line.turn-active {
      opacity: 1;
    }
    .status-line.turn-active::before {
      content: 'üü¢';
    }

    .status-line.turn-waiting {
      opacity: 0.6;
    }
    .status-line.turn-waiting::before {
      content: 'üî¥';
    }

    .progress-badge, .timer-badge {
      background: #e8f5e8;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 0.8em;
      color: #2d5a2d;
    }

    .timer-badge {
      background: #fff3cd;
      color: #856404;
    }

    /* ========== MAIN CONTENT ========== */
    main {
      padding: 20px;
      max-width: 1200px;
      margin: 0 auto;
      min-height: calc(100vh - 160px);
    }

    /* ========== MODO SELECTION ========== */
    .game-mode-container {
      text-align: center;
      padding: 40px 20px;
    }

    .game-mode-container h2 {
      margin-bottom: 30px;
      color: #333;
      font-size: 1.8em;
    }

    .mode-buttons {
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .mode-button {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      background: #fff;
      border: 2px solid #ddd;
      border-radius: 12px;
      padding: 30px 20px;
      cursor: pointer;
      transition: all 0.3s;
      min-width: 200px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .mode-button:hover {
      transform: translateY(-3px);
      border-color: #007bff;
      box-shadow: 0 4px 15px rgba(0,123,255,0.2);
    }

    .mode-icon {
      font-size: 2.5em;
    }

    .mode-title {
      font-size: 1.3em;
      font-weight: bold;
      color: #333;
    }

    .mode-description {
      font-size: 0.9em;
      color: #666;
      text-align: center;
    }

    /* ========== SOLO/MULTI OPTIONS ========== */
    .section-container {
      text-align: center;
      padding: 40px 20px;
    }

    .section-container h2 {
      margin-bottom: 30px;
      color: #333;
      font-size: 1.6em;
    }

    .option-buttons {
      display: flex;
      gap: 15px;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 30px;
    }

    .option-button {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      background: #fff;
      border: 2px solid #ddd;
      border-radius: 10px;
      padding: 20px 15px;
      cursor: pointer;
      transition: all 0.2s;
      min-width: 150px;
    }

    .option-button:hover {
      border-color: #007bff;
      transform: translateY(-2px);
    }

    .option-button.active {
      border-color: #007bff;
      background-color: #f0f8ff;
    }

    /* ========== VIDEO GRID ========== */
    .video-grid-container {
      padding: 20px;
    }

    .video-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: center;
    }

    .video-card {
      background: #fff;
      padding: 15px;
      border: 1px solid #ccc;
      border-radius: 8px;
      width: 200px;
      cursor: pointer;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      transition: transform 0.2s;
      text-align: center;
    }

    .video-card:hover {
      transform: scale(1.03);
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
    }

    /* ========== LESSON SCREEN ========== */
    .video-container {
      text-align: center;
      margin: 20px 0;
    }

    #video {
      max-width: 100%;
      height: auto;
      width: 70%;
      border-radius: 8px;
    }

    .controls {
      text-align: center;
      margin: 20px 0;
    }

    .controls button {
      padding: 12px 24px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1em;
    }

    .controls button:hover {
      background: #0056b3;
    }

    .formed-sentence {
      font-weight: bold;
      margin: 20px 0;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 8px;
      text-align: center;
      min-height: 50px;
      border: 2px dashed #ddd;
    }

    .words-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      margin: 20px 0;
    }

    .word {
      display: inline-block;
      padding: 12px 18px;
      background: #fff;
      border: 2px solid #ddd;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      font-weight: 500;
    }

    .word:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }

    .word.correct {
      background-color: #d4edda;
      border-color: #c3e6cb;
      color: #155724;
    }

    .word.incorrect {
      background-color: #f8d7da;
      border-color: #f5c6cb;
      color: #721c24;
    }

    /* ========== WAITING ROOM ========== */
    .waiting-room {
      text-align: center;
      padding: 40px 20px;
    }

    .room-code {
      font-size: 2em;
      font-weight: bold;
      color: #007bff;
      margin: 20px 0;
      padding: 15px;
      background: #f0f8ff;
      border-radius: 10px;
      border: 2px dashed #007bff;
    }

    .waiting-animation {
      margin: 30px 0;
    }

    .pulse {
      display: inline-block;
      width: 20px;
      height: 20px;
      background: #007bff;
      border-radius: 50%;
      margin: 0 5px;
      animation: pulse 1.5s infinite;
    }

    .pulse:nth-child(2) { animation-delay: 0.3s; }
    .pulse:nth-child(3) { animation-delay: 0.6s; }

    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.2); opacity: 0.7; }
    }

    /* ========== SEARCH ========== */
    .search-container {
      margin: 20px 0;
      text-align: center;
    }

    .search-input {
      width: 100%;
      max-width: 400px;
      padding: 12px 16px;
      border: 2px solid #ddd;
      border-radius: 25px;
      font-size: 1em;
      outline: none;
      transition: border-color 0.2s;
    }

    .search-input:focus {
      border-color: #007bff;
    }

    /* ========== FOOTER ========== */
    .context-footer {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background-color: #fff;
      border-top: 1px solid #ddd;
      box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
      z-index: 1000;
    }

    .footer-nav {
      display: flex;
      justify-content: space-around;
      padding: 12px 0;
    }

    .footer-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      background: none;
      border: none;
      padding: 8px 12px;
      cursor: pointer;
      border-radius: 8px;
      transition: background-color 0.2s;
      min-width: 60px;
    }

    .footer-btn:hover,
    .footer-btn.active {
      background-color: #f0f8ff;
    }

    .footer-icon {
      font-size: 1.3em;
    }

    .footer-text {
      font-size: 0.75em;
      color: #666;
      font-weight: 500;
    }

    /* ========== RESPONSIVE ========== */
    @media (max-width: 768px) {
      .mode-buttons {
        flex-direction: column;
        align-items: center;
      }

      .mode-button {
        width: 100%;
        max-width: 300px;
      }

      .option-buttons {
        flex-direction: column;
        align-items: center;
      }

      .option-button {
        width: 100%;
        max-width: 250px;
      }

      #video {
        width: 95%;
      }

      .nav-text {
        display: none;
      }
    }
  </style>
</head>
<body>

<!-- ========== HEADER ========== -->
<header id="mainHeader" class="main-header">
  <nav class="header-nav">
    <button id="backBtn" class="nav-button hidden" onclick="NavigationController.goBack()">
      <span class="nav-icon">‚Üê</span>
      <span class="nav-text">Voltar</span>
    </button>
    
    <div class="header-center">
      <h1 id="headerTitle" class="header-title">SpeedPhrase</h1>
      
      <!-- Status do exerc√≠cio (s√≥ aparece durante li√ß√µes) -->
      <div id="exerciseStatus" class="exercise-status hidden">
        <div id="playerStatus" class="status-line">
          <span id="progressBadge" class="progress-badge"></span>
          <span id="timer" class="timer-badge"></span>
        </div>
        
        <div id="opponentStatus" class="status-line hidden">
          <span id="opponentProgressBadge" class="progress-badge"></span>
          <span id="opponentTimer" class="timer-badge"></span>
        </div>
      </div>
    </div>

    <button id="homeBtn" class="nav-button" onclick="NavigationController.goHome()">
      <span class="nav-icon">üè†</span>
      <span class="nav-text">Home</span>
    </button>
  </nav>
</header>

<!-- ========== MAIN CONTENT ========== -->
<main>

  <!-- ========== HOME: SELE√á√ÉO DE MODO ========== -->
  <section id="homeSection" class="game-mode-container">
    <h2>Escolha o modo de jogo</h2>
    <div class="mode-buttons">
      <button class="mode-button" onclick="NavigationController.goToMode('solo')">
        <span class="mode-icon">üéØ</span>
        <span class="mode-title">Solo</span>
        <span class="mode-description">Jogue no seu pr√≥prio ritmo</span>
      </button>
      <button class="mode-button" onclick="NavigationController.goToMode('multiplayer')">
        <span class="mode-icon">üë•</span>
        <span class="mode-title">Multiplayer</span>
        <span class="mode-description">Desafie outros jogadores</span>
      </button>
    </div>
  </section>

  <!-- ========== MODO SOLO ========== -->
  <section id="soloModeSection" class="section-container hidden">
    <h2>Modo Solo</h2>
    <p style="margin-bottom: 20px; color: #666;">Escolha o tipo de li√ß√£o:</p>
    
    <!-- Bot√µes de op√ß√£o (sempre vis√≠veis no modo solo) -->
    <div class="option-buttons">
      <button class="option-button" onclick="NavigationController.goToSoloOption('avulsas')">
        <span class="mode-icon">üìÇ</span>
        <span class="mode-title">Avulsas</span>
      </button>
      <button class="option-button" onclick="NavigationController.goToSoloOption('trilha')">
        <span class="mode-icon">üõ§Ô∏è</span>
        <span class="mode-title">Trilha</span>
      </button>
      <button class="option-button" onclick="NavigationController.goToSoloOption('pesquisar')">
        <span class="mode-icon">üîç</span>
        <span class="mode-title">Pesquisar</span>
      </button>
    </div>

    <!-- Subse√ß√µes das li√ß√µes -->
    <div id="avulsas-section" class="video-grid-container hidden">
      <h3 style="text-align: center; margin-bottom: 20px;">Li√ß√µes Avulsas</h3>
      <div id="avulsas-grid" class="video-grid">
        <!-- Li√ß√µes ser√£o injetadas aqui via JavaScript -->
        <div class="video-card" onclick="startLesson('lesson1')">
          <h4>500 Miles</h4>
          <p>The Proclaimers</p>
        </div>
        <div class="video-card" onclick="startLesson('lesson2')">
          <h4>Yesterday</h4>
          <p>The Beatles</p>
        </div>
      </div>
    </div>

    <div id="trilha-section" class="video-grid-container hidden">
      <h3 style="text-align: center; margin-bottom: 20px;">Trilha de Aprendizado</h3>
      <div id="trilha-grid" class="video-grid">
        <!-- Trilha ser√° injetada aqui via JavaScript -->
        <div class="video-card" onclick="startLesson('trail1')">
          <h4>N√≠vel 1: B√°sico</h4>
          <p>Frases simples</p>
        </div>
        <div class="video-card" onclick="startLesson('trail2')">
          <h4>N√≠vel 2: Intermedi√°rio</h4>
          <p>Frases complexas</p>
        </div>
      </div>
    </div>

    <div id="pesquisar-section" class="video-grid-container hidden">
      <h3 style="text-align: center; margin-bottom: 20px;">Pesquisar Li√ß√µes</h3>
      <div class="search-container">
        <input type="search" class="search-input" placeholder="Digite para buscar li√ß√µes..." />
      </div>
      <div id="search-results" class="video-grid">
        <!-- Resultados da busca aparecer√£o aqui -->
      </div>
    </div>
  </section>

  <!-- ========== MODO MULTIPLAYER ========== -->
  <section id="multiModeSection" class="section-container hidden">
    <h2>Multiplayer</h2>
    <p style="margin-bottom: 20px; color: #666;">Entre em partidas ou crie a sua:</p>
    
    <!-- Op√ß√µes iniciais do multiplayer -->
    <div class="option-buttons">
      <button class="option-button" onclick="NavigationController.goToMultiOption('abertas')">
        <span class="mode-icon">üéÆ</span>
        <span class="mode-title">Partidas Abertas</span>
      </button>
      <button class="option-button" onclick="NavigationController.goToMultiOption('criar')">
        <span class="mode-icon">‚ûï</span>
        <span class="mode-title">Criar Partida</span>
      </button>
    </div>

    <!-- Lista de partidas abertas -->
    <div id="partidas-abertas-section" class="video-grid-container hidden">
      <h3 style="text-align: center; margin-bottom: 20px;">Partidas Dispon√≠veis</h3>
      <div id="waitingGamesList" class="video-grid">
        <!-- Partidas abertas ser√£o injetadas aqui -->
        <div class="video-card" onclick="joinGame('game1')">
          <h4>500 Miles</h4>
          <p>Jogador: Ana</p>
          <small>Aguardando...</small>
        </div>
      </div>
    </div>
  </section>

  <!-- ========== CRIAR PARTIDA ========== -->
  <section id="createGameSection" class="section-container hidden">
    <h2>Criar Nova Partida</h2>
    <p style="margin-bottom: 20px; color: #666;">Escolha uma li√ß√£o para desafiar outros jogadores:</p>
    
    <!-- Mesmas op√ß√µes do solo, mas para criar partida -->
    <div class="option-buttons">
      <button class="option-button" onclick="NavigationController.goToCreateGame('avulsas')">
        <span class="mode-icon">üìÇ</span>
        <span class="mode-title">Avulsas</span>
      </button>
      <button class="option-button" onclick="NavigationController.goToCreateGame('trilha')">
        <span class="mode-icon">üõ§Ô∏è</span>
        <span class="mode-title">Trilha</span>
      </button>
      <button class="option-button" onclick="NavigationController.goToCreateGame('pesquisar')">
        <span class="mode-icon">üîç</span>
        <span class="mode-title">Pesquisar</span>
      </button>
    </div>

    <!-- Subse√ß√µes para criar partida (reutilizam o mesmo conte√∫do) -->
    <div id="create-avulsas-section" class="video-grid-container hidden">
      <h3 style="text-align: center; margin-bottom: 20px;">Escolha uma Li√ß√£o Avulsa</h3>
      <div id="create-avulsas-grid" class="video-grid">
        <div class="video-card" onclick="createGameWithLesson('lesson1')">
          <h4>500 Miles</h4>
          <p>The Proclaimers</p>
        </div>
      </div>
    </div>

    <div id="create-trilha-section" class="video-grid-container hidden">
      <h3 style="text-align: center; margin-bottom: 20px;">Escolha uma Li√ß√£o da Trilha</h3>
      <div id="create-trilha-grid" class="video-grid">
        <div class="video-card" onclick="createGameWithLesson('trail1')">
          <h4>N√≠vel 1: B√°sico</h4>
          <p>Frases simples</p>
        </div>
      </div>
    </div>

    <div id="create-pesquisar-section" class="video-grid-container hidden">
      <h3 style="text-align: center; margin-bottom: 20px;">Pesquisar para Criar Partida</h3>
      <div class="search-container">
        <input type="search" class="search-input" placeholder="Busque uma li√ß√£o para criar partida..." />
      </div>
      <div id="create-search-results" class="video-grid"></div>
    </div>
  </section>

  <!-- ========== SALA DE ESPERA ========== -->
  <section id="waitingRoomSection" class="waiting-room hidden">
    <h2>Sala de Espera</h2>
    <p>Compartilhe o c√≥digo com seus amigos:</p>
    <div class="room-code" id="roomCode">ABC123</div>
    
    <div class="waiting-animation">
      <div class="pulse"></div>
      <div class="pulse"></div>
      <div class="pulse"></div>
    </div>
    
    <p id="waitingStatus">Aguardando oponente entrar na sala...</p>
    <button class="controls button" onclick="NavigationController.cancelWaitingRoom()" style="margin-top: 20px; background: #dc3545;">
      Cancelar Partida
    </button>
  </section>

  <!-- ========== TELA DA LI√á√ÉO ========== -->
  <section id="lessonSection" class="hidden">
    <!-- V√≠deo -->
    <div class="video-container">
      <video id="video" controls>
        <source src="https://f005.backblazeb2.com/file/Avulsas/Im_Gonna_Be_-_500_Miles.mp4" type="video/mp4" />
      </video>
    </div>
    
    <!-- Controles -->
    <div class="controls">
      <button onclick="playCurrentSubtitle()">‚ñ∂Ô∏è Tocar trecho atual</button>
    </div>

    <!-- Frase formada -->
    <div class="formed-sentence" id="formedSentence">
      Arraste as palavras aqui para formar a frase
    </div>

    <!-- Palavras embaralhadas -->
    <div class="words-container" id="shuffledWords">
      <!-- Palavras ser√£o injetadas aqui -->
      <div class="word" onclick="selectWord(this)">I'm</div>
      <div class="word" onclick="selectWord(this)">gonna</div>
      <div class="word" onclick="selectWord(this)">be</div>
      <div class="word" onclick="selectWord(this)">the</div>
      <div class="word" onclick="selectWord(this)">one</div>
    </div>
  </section>

</main>

<!-- ========== FOOTER CONTEXTUAL ========== -->

<!-- Footer para Li√ß√µes (Solo + Criar Partida) -->
<footer id="lessonsFooter" class="context-footer hidden">
  <nav class="footer-nav">
    <button id="avulsasFooterBtn" class="footer-btn" onclick="NavigationController.switchLessonType('avulsas')">
      <span class="footer-icon">üìÇ</span>
      <span class="footer-text">Avulsas</span>
    </button>
    <button id="trilhaFooterBtn" class="footer-btn" onclick="NavigationController.switchLessonType('trilha')">
      <span class="footer-icon">üõ§Ô∏è</span>
      <span class="footer-text">Trilha</span>
    </button>
    <button id="pesquisarFooterBtn" class="footer-btn" onclick="NavigationController.switchLessonType('pesquisar')">
      <span class="footer-icon">üîç</span>
      <span class="footer-text">Pesquisar</span>
    </button>
  </nav>
</footer>

<!-- Footer para Multiplayer -->
<footer id="multiFooter" class="context-footer hidden">
  <nav class="footer-nav">
    <button id="abertasFooterBtn" class="footer-btn" onclick="NavigationController.switchMultiType('abertas')">
      <span class="footer-icon">üéÆ</span>
      <span class="footer-text">Abertas</span>
    </button>
    <button id="criarFooterBtn" class="footer-btn" onclick="NavigationController.switchMultiType('criar')">
      <span class="footer-icon">‚ûï</span>
      <span class="footer-text">Criar</span>
    </button>
  </nav>
</footer>

<script>
// ========== NAVIGATION CONTROLLER ==========
const NavigationController = {
  currentSection: 'home',
  navigationStack: [],

  // Utilit√°rios
  hideAllSections() {
    document.querySelectorAll('main > section').forEach(section => {
      section.classList.add('hidden');
    });
  },

  hideAllFooters() {
    document.querySelectorAll('.context-footer').forEach(footer => {
      footer.classList.add('hidden');
    });
  },

  updateHeader(title, showBack = false) {
    document.getElementById('headerTitle').textContent = title;
    document.getElementById('backBtn').classList.toggle('hidden', !showBack);
  },

  showFooter(footerType) {
    this.hideAllFooters();
    if (footerType) {
      document.getElementById(footerType + 'Footer').classList.remove('hidden');
    }
  },

  // Navega√ß√£o principal
  goHome() {
    this.hideAllSections();
    this.hideAllFooters();
    document.getElementById('homeSection').classList.remove('hidden');
    this.updateHeader('SpeedPhrase', false);
    this.currentSection = 'home';
    this.navigationStack = [];
  },

  goBack() {
    if (this.navigationStack.length > 0) {
      const previous = this.navigationStack.pop();
      this[previous.method](...previous.args);
    } else {
      this.goHome();
    }
  },

  // Modo Solo
  goToMode(mode) {
    this.navigationStack.push({ method: 'goHome', args: [] });
    
    if (mode === 'solo') {
      this.hideAllSections();
      document.getElementById('soloModeSection').classList.remove('hidden');
      this.updateHeader('Modo Solo', true);
      this.showFooter('lessons');
      this.currentSection = 'solo';
    } else if (mode === 'multiplayer') {
      this.hideAllSections();
      document.getElementById('multiModeSection').classList.remove('hidden');
      this.updateHeader('Multiplayer', true);
      this.showFooter('multi');
      this.currentSection = 'multiplayer';
    }
  },

  goToSoloOption(option) {
    this.navigationStack.push({ method: 'goToMode', args: ['solo'] });
    
    // Esconde todas as subse√ß√µes do solo
    document.querySelectorAll('#soloModeSection .video-grid-container').forEach(section => {
      section.classList.add('hidden');
    });

    // Mostra a subse√ß√£o espec√≠fica
    document.getElementById(option + '-section').classList.remove('hidden');
    
    // Atualiza header
    const titles = {
      'avulsas': 'Li√ß√µes Avulsas',
      'trilha': 'Trilha de Aprendizado', 
      'pesquisar': 'Pesquisar Li√ß√µes'
    };
    this.updateHeader(titles[option], true);

    // Atualiza footer ativo
    this.updateFooterActive('lessons', option);
  },

  // Modo Multiplayer
  goToMultiOption(option) {
    this.navigationStack.push({ method: 'goToMode', args: ['multiplayer'] });

    if (option === 'abertas') {
      // Esconde se√ß√£o principal do multi, mostra partidas abertas
      document.querySelectorAll('#multiModeSection .video-grid-container').forEach(section => {
        section.classList.add('hidden');
      });
      document.getElementById('partidas-abertas-section').classList.remove('hidden');
      this.updateHeader('Partidas Abertas', true);
      this.updateFooterActive('multi', 'abertas');
      
    } else if (option === 'criar') {
      this.hideAllSections();
      document.getElementById('createGameSection').classList.remove('hidden');
      this.updateHeader('Criar Partida', true);
      this.showFooter('lessons'); // Usa o mesmo footer de li√ß√µes
    }
  },

  goToCreateGame(option) {
    this.navigationStack.push({ method: 'goToMultiOption', args: ['criar'] });
    
    // Esconde todas as subse√ß√µes de criar partida
    document.querySelectorAll('#createGameSection .video-grid-container').forEach(section => {
      section.classList.add('hidden');
    });

    // Mostra a subse√ß√£o espec√≠fica
    document.getElementById('create-' + option + '-section').classList.remove('hidden');
    
    // Atualiza header
    const titles = {
      'avulsas': 'Criar: Li√ß√µes Avulsas',
      'trilha': 'Criar: Trilha de Aprendizado',
      'pesquisar': 'Criar: Pesquisar Li√ß√µes'
    };
    this.updateHeader(titles[option], true);

    // Atualiza footer ativo
    this.updateFooterActive('lessons', option);
  },

  // Fun√ß√µes de troca r√°pida via footer
  switchLessonType(type) {
    if (this.currentSection === 'solo') {
      this.goToSoloOption(type);
    } else if (document.getElementById('createGameSection').classList.contains('hidden') === false) {
      this.goToCreateGame(type);
    }
  },

  switchMultiType(type) {
    this.goToMultiOption(type);
  },

  updateFooterActive(footerType, activeOption) {
    // Remove active de todos os bot√µes do footer
    document.querySelectorAll(`#${footerType}Footer .footer-btn`).forEach(btn => {
      btn.classList.remove('active');
    });

    // Adiciona active ao bot√£o correto
    const buttonMap = {
      'lessons': {
        'avulsas': 'avulsasFooterBtn',
        'trilha': 'trilhaFooterBtn', 
        'pesquisar': 'pesquisarFooterBtn'
      },
      'multi': {
        'abertas': 'abertasFooterBtn',
        'criar': 'criarFooterBtn'
      }
    };

    const buttonId = buttonMap[footerType]?.[activeOption];
    if (buttonId) {
      document.getElementById(buttonId)?.classList.add('active');
    }
  },

  // Sala de espera
  goToWaitingRoom(lessonData) {
    this.navigationStack.push({ method: 'goToCreateGame', args: [lessonData.type] });
    
    this.hideAllSections();
    this.hideAllFooters();
    document.getElementById('waitingRoomSection').classList.remove('hidden');
    this.updateHeader('Aguardando Oponente', true);
    
    // Gera c√≥digo da sala
    const roomCode = Math.random().toString(36).substring(2, 8).toUpperCase();
    document.getElementById('roomCode').textContent = roomCode;
  },

  cancelWaitingRoom() {
    this.goBack();
  },

  // Iniciar li√ß√£o
  startLesson(lessonId, isMultiplayer = false) {
    this.hideAllSections();
    this.hideAllFooters();
    document.getElementById('lessonSection').classList.remove('hidden');
    
    if (isMultiplayer) {
      this.updateHeader('Li√ß√£o: Multiplayer', true);
      document.getElementById('exerciseStatus').classList.remove('hidden');
      document.getElementById('opponentStatus').classList.remove('hidden');
    } else {
      this.updateHeader('Li√ß√£o: Solo', true);
      document.getElementById('exerciseStatus').classList.remove('hidden');
      document.getElementById('opponentStatus').classList.add('hidden');
    }

    // Inicializa a li√ß√£o
    this.initializeLesson(lessonId);
  }
};

// ========== LESSON FUNCTIONS ==========
function startLesson(lessonId) {
  NavigationController.startLesson(lessonId, false);
}

function createGameWithLesson(lessonId) {
  // Simula cria√ß√£o da partida e vai para sala de espera
  NavigationController.goToWaitingRoom({ lessonId, type: 'avulsas' });
}

function joinGame(gameId) {
  NavigationController.startLesson(gameId, true);
}

function playCurrentSubtitle() {
  const video = document.getElementById('video');
  video.currentTime = 10; // Exemplo: vai para 10 segundos
  video.play();
}

function selectWord(wordElement) {
  const formedSentence = document.getElementById('formedSentence');
  
  // Se √© a primeira palavra, limpa o placeholder
  if (formedSentence.textContent === 'Arraste as palavras aqui para formar a frase') {
    formedSentence.textContent = '';
  }
  
  // Adiciona a palavra √† frase
  formedSentence.textContent += (formedSentence.textContent ? ' ' : '') + wordElement.textContent;
  
  // Remove a palavra das op√ß√µes
  wordElement.style.display = 'none';
  
  // Verifica se a frase est√° completa (exemplo simples)
  checkSentence();
}

function checkSentence() {
  const formed = document.getElementById('formedSentence').textContent;
  const correct = "I'm gonna be the one"; // Exemplo
  
  if (formed === correct) {
    alert('Correto! üéâ');
    // Aqui voc√™ pode avan√ßar para pr√≥xima frase ou finalizar li√ß√£o
  }
}

// Inicializa√ß√£o
document.addEventListener('DOMContentLoaded', function() {
  NavigationController.goHome();
});
</script>

</body>
</html>
